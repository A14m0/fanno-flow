import numpy as np
import matplotlib.pyplot as plt


SAMPLERATE = 48000


DATA = [-0.0032085888, -0.0035689545, -0.00358471, -0.002471818, -0.0029048603, -0.004199506, -0.003292209, -0.0016476095, -0.0033481, -0.0035897873, -0.0011201085, -0.0012452625, -0.0022161547, -0.0017314767, -0.00010553957, 0.00051613466, -0.0005276108, -0.00066613284, -0.0008746825, 9.713217e-5, 0.0022903353, 0.0014793687, 0.00011730974, 0.0006679743, 0.0018222423, 0.0026914997, 0.0016531339, 0.0010405809, 0.0027931733, 0.003306624, 0.0025690638, 0.0023435806, 0.0012889615, 0.0015939795, 0.0039268383, 0.003914898, 0.0023180689, 0.0030237685, 0.0047525493, 0.004368756, 0.0036531242, 0.0039561354, 0.003494007, 0.0042097326, 0.0050086714, 0.0033914791, 0.0034969058, 0.004949594, 0.0041883583, 0.0038579665, 0.005620732, 0.0053501925, 0.0028816506, 0.0035574902, 0.005275812, 0.0044500614, 0.004111236, 0.0041182903, 0.0034074741, 0.0039527323, 0.0046273232, 0.003771768, 0.00340186, 0.0040047616, 0.0038430432, 0.0035247616, 0.003963178, 0.0041297134, 0.0028456657, 0.0022832376, 0.0031872639, 0.002349294, 0.0020726803, 0.0030895972, 0.002282914, 0.001971415, 0.0023640979, 0.0024981988, 0.0024001668, 0.0013034663, 0.0019713752, 0.0032903028, 0.002055205, 0.00041602878, 0.00010498814, 0.0008945063, 0.0021111057, 0.002386068, 0.0014140437, 0.0008355502, 0.00060107815, -5.43301e-5, 0.000856084, 0.0016365277, -0.000172448, -0.00053232955, 0.001164221, 0.00042101764, -0.0009283392, 0.00067646307, 0.0015797374, -0.0003100061, -0.00037597126, 0.0020236233, 0.0014471237, -0.0013886312, -0.0007954731, 0.0013588055, 0.0013020054, 0.0006001181, 0.00019540792, -0.00016539471, 0.00019460611, 0.0013985287, 0.0018600295, 0.0009107585, 0.00063056615, 0.0014322596, 0.0012799448, 0.0003881578, 0.001161912, 0.002626469, 0.0023435291, 0.0016377445, 0.0016247365, 0.0014754838, 0.001677772, 0.0031298436, 0.003167549, 0.0013386135, 0.002858549, 0.0050589973, 0.0028664886, 0.0014233916, 0.0036693215, 0.0048338957, 0.003029239, 0.0028796024, 0.00481366, 0.004647539, 0.0035391406, 0.0032653548, 0.004103291, 0.0054706666, 0.0063173138, 0.007270271, 0.006545636, 0.0051060887, 0.005471969, 0.0062326994, 0.006884587, 0.00619586, 0.0054361066, 0.0072741704, 0.008710136, 0.008020704, 0.0068152687, 0.0064010127, 0.0071639004, 0.008038033, 0.008696329, 0.008663384, 0.007433898, 0.007676732, 0.009762725, 0.009725877, 0.008710617, 0.009609183, 0.009685028, 0.008485219, 0.009225881, 0.010956862, 0.011024515, 0.010741403, 0.0107491845, 0.010489421, 0.011049397, 0.010587671, 0.010021846, 0.012175635, 0.012859235, 0.011289639, 0.011294914, 0.011844389, 0.011182836, 0.0110397, 0.012190877, 0.012280357, 0.012285931, 0.013344726, 0.01263406, 0.011968003, 0.013366396, 0.013617212, 0.012594156, 0.012313191, 0.01201999, 0.011880867, 0.01211733, 0.011359336, 0.011876478, 0.0140906535, 0.013494859, 0.012231359, 0.014315522, 0.0150354775, 0.012207041, 0.01160279, 0.013237945, 0.012632212, 0.0119286915, 0.01257095, 0.011973815, 0.011752406, 0.0133981975, 0.013188828, 0.011464828, 0.012543307, 0.013600077, 0.011940647, 0.010936446, 0.011320468, 0.011903614, 0.011781819, 0.011599983, 0.012219448, 0.01098482, 0.009934117, 0.011884566, 0.012409608, 0.010915259, 0.010637843, 0.011466101, 0.012204461, 0.011734641, 0.011344498, 0.011941543, 0.0116246985, 0.011608548, 0.011998137, 0.010746363, 0.010501695, 0.012098262, 0.012642546, 0.011474145, 0.010575737, 0.011664337, 0.0117892595, 0.010680926, 0.012264045, 0.013096239, 0.010682649, 0.010009333, 0.011543855, 0.0117608365, 0.011126826, 0.011879486, 0.012958314, 0.011741746, 0.01072429, 0.012720671, 0.012968435, 0.011153134, 0.01265074, 0.01409273, 0.012961388, 0.012933984, 0.013509012, 0.013242403, 0.012580385, 0.012957977, 0.013992282, 0.01293286, 0.011783674, 0.012172915, 0.012460635, 0.012582905, 0.012257326, 0.012379418, 0.012703775, 0.012531601, 0.013853076, 0.014230318, 0.012107684, 0.01213602, 0.0145088695, 0.014701061, 0.012731862, 0.012793104, 0.014749776, 0.014390222, 0.01259578, 0.013390599, 0.014300749, 0.012372807, 0.012234222, 0.014239302, 0.01430468, 0.0137079805, 0.013123082, 0.013095405, 0.014069246, 0.0139631, 0.013277897, 0.013417008, 0.014706878, 0.014021162, 0.011838273, 0.0133299325, 0.014290098, 0.0134341065, 0.014474925, 0.014431971, 0.013171442, 0.012885769, 0.014776461, 0.0154997315, 0.013056635, 0.014450619, 0.016552506, 0.014733592, 0.014211266, 0.014408527, 0.014293764, 0.014321276, 0.0144294165, 0.015517891, 0.014882099, 0.013349254, 0.013922835, 0.014869796, 0.014054742, 0.012849868, 0.013995222, 0.015763806, 0.015784815, 0.015111142, 0.014400885, 0.014130249, 0.01462518, 0.015254917, 0.015465956, 0.015362717, 0.014934434, 0.014046507, 0.014586873, 0.016398653, 0.015601415, 0.014063348, 0.015210411, 0.014813217, 0.013426358, 0.015230468, 0.015586023, 0.013929263, 0.0146048665, 0.014686982, 0.0134070255, 0.014212306, 0.015114796, 0.013982028, 0.014050964, 0.016002635, 0.016063916, 0.014345892, 0.0143514555, 0.015351898, 0.0145012755, 0.013803975, 0.014918767, 0.015261697, 0.014688236, 0.014455664, 0.014675951, 0.015205415, 0.014234984, 0.012261162, 0.012541591, 0.01431014, 0.01454407, 0.0136827, 0.013119427, 0.013148679, 0.013221718, 0.012667822, 0.013355674, 0.014501444, 0.013617926, 0.01294683, 0.013438352, 0.013593372, 0.013180368, 0.013397839, 0.013845442, 0.012638283, 0.0126457745, 0.013720815, 0.012666782, 0.012142265, 0.012340475, 0.01208981, 0.01275066, 0.012958031, 0.011958225, 0.012152208, 0.013749715, 0.013425013, 0.012236029, 0.012913944, 0.0132606095, 0.0129764015, 0.013056016, 0.0128445225, 0.012961685, 0.0133111095, 0.012966253, 0.012680684, 0.013591255, 0.013885769, 0.012795706, 0.013046325, 0.013428504, 0.012736743, 0.013652686, 0.0141562065, 0.012857852, 0.013186544, 0.01410512, 0.013568741, 0.013708433, 0.015011747, 0.014428192, 0.012491301, 0.0138203055, 0.015549433, 0.0134263905, 0.012380173, 0.01432469, 0.014763831, 0.013206039, 0.0131040765, 0.013953123, 0.014009272, 0.014957204, 0.014554298, 0.012353521, 0.012929573, 0.014178668, 0.013469248, 0.012978404, 0.013671762, 0.014082722, 0.012927419, 0.012884222, 0.013893421, 0.01274583, 0.011759283, 0.01259332, 0.013585216, 0.013605695, 0.012622615, 0.012603987, 0.012956245, 0.012475083, 0.012390513, 0.012839927, 0.013113525, 0.011780071, 0.011133311, 0.012367034, 0.011620192, 0.01160953, 0.012556264, 0.010306917, 0.009544676, 0.011574772, 0.011351268, 0.009727176, 0.01002407, 0.010379662, 0.009393931, 0.009562457, 0.009638681, 0.008895078, 0.009266236, 0.009700319, 0.00853559, 0.0064386656, 0.006543041, 0.00764104, 0.0072209276, 0.006467239, 0.0055343695, 0.0062971767, 0.006770184, 0.004603256, 0.0043313, 0.0053995084, 0.005319168, 0.004812031, 0.0041577187, 0.003448601, 0.0027504365, 0.0027168416, 0.0021156748, 0.0016814998, 0.0015794706, -0.00038531446, -0.00023656356, 0.0018229114, 0.0007077282, -0.0008397734]




def parse_from_rust_output(v):
    """Helper function to convert the raw Rust output of the Complex data
    into something useful for Python. Takes in the raw copied stdout from the
    Rust program, returns an array of Python Complex numbers"""
    ret = []
    v = v.replace("[", "").replace("]", "")
    v = v.split("},")

    for a in v:
        a = a.split(",")
        a1 = a[0]
        a2 = a[1]
        i = float(a1.split(":")[1].replace(",",""))
        q = float(a2.split(":")[1].replace("}", ""))
        ret.append(complex(i, q))

    return ret



print("Running FFT on data...")
fft_result = np.fft.fft(DATA)

print("Building frequency bins...")
frequencies = np.fft.fftfreq(len(DATA), 1/SAMPLERATE)

#print(fft_result)

# dat = parse_from_rust_output(DATA)

print("Building graph...")
plt.plot(np.abs(fft_result))
plt.xlabel("Frequency (Hz)")
plt.ylabel("Magnitude")
plt.title("FFT of Provided Signal")
plt.show()